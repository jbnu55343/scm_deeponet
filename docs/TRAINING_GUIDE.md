ğŸš€ è®­ç»ƒè„šæœ¬ä½¿ç”¨æŒ‡å—
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ã€è„šæœ¬ä¿¡æ¯ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

è„šæœ¬: train_mlp_speed.py
åŠŸèƒ½: ä½¿ç”¨ MLP æ¨¡å‹è¿›è¡Œé€Ÿåº¦é¢„æµ‹
æ¡†æ¶: PyTorch
æ¨¡å‹: SimpleMLP (3 å±‚éšè—å±‚: 256 â†’ 128 â†’ 64 â†’ 1)
è¾“å…¥: .npz æ ¼å¼çš„æ•°æ®é›†
è¾“å‡º: è®­ç»ƒæŒ‡æ ‡ (MAE, RMSE, RÂ²) + ç»“æœ JSON æ–‡ä»¶


ã€å¿…è¦çš„ä¾èµ–ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

torch
numpy

å®‰è£…:
  pip install torch numpy

å¦‚æœæœ‰ GPU:
  pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118


ã€åŸºæœ¬ç”¨æ³•ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

è®­ç»ƒ baseline ç‰ˆæœ¬ (æ— ç©ºé—´ç‰¹å¾):
  python scripts/train_mlp_speed.py --data data/dataset_sumo_5km_lag12_no_spatial.npz --epochs 100

è®­ç»ƒ spatial ç‰ˆæœ¬ (æœ‰ç©ºé—´ç‰¹å¾):
  python scripts/train_mlp_speed.py --data data/dataset_sumo_5km_lag12_with_spatial.npz --epochs 100

å¸¦æ›´å¤šå‚æ•°çš„è®­ç»ƒ:
  python scripts/train_mlp_speed.py \
    --data data/dataset_sumo_5km_lag12_no_spatial.npz \
    --epochs 200 \
    --batch_size 512 \
    --lr 0.0005 \
    --weight_decay 1e-4


ã€å‚æ•°è¯´æ˜ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

--data (å¿…éœ€)
  .npz æ•°æ®æ–‡ä»¶è·¯å¾„
  ç¤ºä¾‹: data/dataset_sumo_5km_lag12_no_spatial.npz

--epochs (å¯é€‰, é»˜è®¤: 100)
  è®­ç»ƒè½®æ•° (epoch)
  æ¨è: 50-200 (å–å†³äºæ•°æ®å¤§å°)

--batch_size (å¯é€‰, é»˜è®¤: 256)
  æ‰¹å¤§å°
  æ¨è: 128-512
  GPU: å¯ä»¥ç”¨æ›´å¤§çš„å€¼ (å¦‚ 1024)

--lr (å¯é€‰, é»˜è®¤: 0.001)
  å­¦ä¹ ç‡ (Adam ä¼˜åŒ–å™¨)
  æ¨è: 0.0001-0.001

--weight_decay (å¯é€‰, é»˜è®¤: 1e-5)
  L2 æ­£åˆ™åŒ–ç³»æ•°
  æ¨è: 1e-5 åˆ° 1e-4


ã€è¾“å‡ºè¯´æ˜ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ‰“å°:

  [INFO] åŠ è½½æ•°æ®: data/dataset_sumo_5km_lag12_no_spatial.npz
  [INFO] X å½¢çŠ¶: (XXXX, 16974, 85)
  [INFO] Y å½¢çŠ¶: (XXXX, 16974)
  [INFO] å±•å¹³å X: (XXXXXXXXX, 85), Y: (XXXXXXXXX, 1)
  [INFO] å»æ‰ NaN å: (XXXXXXXX, 85)
  ...
  [INFO] ä½¿ç”¨è®¾å¤‡: cuda (æˆ– cpu)
  [INFO] æ¨¡å‹åˆ›å»º: input_dim=85, hidden=[256, 128, 64], output_dim=1
  
  ======================================================================
  å¼€å§‹è®­ç»ƒ: 100 ä¸ª epoch
  ======================================================================
  
  Epoch   5/100 | Train Loss: 0.123456 | Val Loss: 0.234567
  Epoch  10/100 | Train Loss: 0.112345 | Val Loss: 0.223456
  ...
  
  ======================================================================
  æœ€ä½³æ¨¡å‹: Epoch 87 (Val Loss: 0.098765)
  ======================================================================
  
  Phase      MAE          RMSE         RÂ²
  ----------------------------------------------
  train      3.2145       4.5678       0.8765
  val        3.4567       4.8901       0.8543
  test       3.5678       5.0123       0.8421

  [INFO] ç»“æœå·²ä¿å­˜åˆ°: dataset_sumo_5km_lag12_no_spatial_results.json


ã€è¾“å‡ºæ–‡ä»¶ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ä¸ºæ¯ä¸ªæ•°æ®æ–‡ä»¶ç”Ÿæˆ JSON ç»“æœæ–‡ä»¶:

  baseline è®­ç»ƒ:
    dataset_sumo_5km_lag12_no_spatial_results.json
  
  spatial è®­ç»ƒ:
    dataset_sumo_5km_lag12_with_spatial_results.json

å†…å®¹ç¤ºä¾‹:
  {
    "data_file": "data/dataset_sumo_5km_lag12_no_spatial.npz",
    "model": "SimpleMLP",
    "epochs": 100,
    "batch_size": 256,
    "learning_rate": 0.001,
    "best_epoch": 87,
    "metrics": {
      "train": {"mae": 3.2145, "rmse": 4.5678, "r2": 0.8765},
      "val": {"mae": 3.4567, "rmse": 4.8901, "r2": 0.8543},
      "test": {"mae": 3.5678, "rmse": 5.0123, "r2": 0.8421}
    },
    "timestamp": "2025-11-29T14:30:45.123456"
  }


ã€å¯¹æ¯”å®éªŒæ­¥éª¤ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1ï¸âƒ£ ç¬¬ä¸€æ­¥ï¼šç¡®ä¿æ•°æ®å·²ç”Ÿæˆ

   ls data/dataset_sumo_5km_lag12_*.npz

   åº”è¯¥çœ‹åˆ°:
   âœ“ data/dataset_sumo_5km_lag12_no_spatial.npz
   âœ“ data/dataset_sumo_5km_lag12_with_spatial.npz


2ï¸âƒ£ ç¬¬äºŒæ­¥ï¼šè®­ç»ƒ baseline ç‰ˆæœ¬

   python train_mlp_speed.py --data data/dataset_sumo_5km_lag12_no_spatial.npz --epochs 100

   é¢„æœŸè€—æ—¶:
   â€¢ CPU: 30-60 åˆ†é’Ÿ
   â€¢ GPU: 5-10 åˆ†é’Ÿ

   è®°å½•è¾“å‡º:
   â€¢ æœ€ä½³ epoch
   â€¢ Test MAE, RMSE, RÂ²


3ï¸âƒ£ ç¬¬ä¸‰æ­¥ï¼šè®­ç»ƒ spatial ç‰ˆæœ¬

   python train_mlp_speed.py --data data/dataset_sumo_5km_lag12_with_spatial.npz --epochs 100

   é¢„æœŸè€—æ—¶:
   â€¢ CPU: 40-80 åˆ†é’Ÿ (ç‰¹å¾å¤šäº† 56%)
   â€¢ GPU: 7-12 åˆ†é’Ÿ

   è®°å½•è¾“å‡º:
   â€¢ æœ€ä½³ epoch
   â€¢ Test MAE, RMSE, RÂ²


4ï¸âƒ£ ç¬¬å››æ­¥ï¼šæ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹çš„æ€§èƒ½

   æŸ¥çœ‹ä¸¤ä¸ª JSON æ–‡ä»¶çš„ test æŒ‡æ ‡:
   
   baseline:  MAE=X.XXX, RMSE=X.XXX, RÂ²=0.XXXX
   spatial:   MAE=X.XXX, RMSE=X.XXX, RÂ²=0.XXXX
   
   è®¡ç®—æ”¹è¿›:
   â€¢ Î”RÂ² = (spatial_r2 - baseline_r2) Ã— 100%
   â€¢ Î”MAE = (baseline_mae - spatial_mae) / baseline_mae Ã— 100%
   â€¢ Î”RMSE = (baseline_rmse - spatial_rmse) / baseline_rmse Ã— 100%
   
   å¦‚æœ Î”RÂ² > 0 (å³ä½¿åªæœ‰ 0.5-1%)ï¼Œè¯´æ˜ç©ºé—´ç‰¹å¾æœ‰å¸®åŠ©ï¼


ã€é¢„æœŸç»“æœç¤ºä¾‹ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Baseline (æ— ç©ºé—´ç‰¹å¾):
  Test MAE:  6.24 km/h
  Test RMSE: 9.30 km/h
  Test RÂ²:   0.8333

Spatial (æœ‰ç©ºé—´ç‰¹å¾):
  Test MAE:  6.05 km/h         (-3.0%)
  Test RMSE: 9.08 km/h         (-2.4%)
  Test RÂ²:   0.8420            (+1.0%)

ç»“è®º: ç©ºé—´ç‰¹å¾è™½ç„¶åªæå‡äº† ~1% çš„ RÂ²ï¼Œä½†è¿™è¶³ä»¥è¯æ˜å…¶æœ‰æ•ˆæ€§ï¼


ã€æ•…éšœæ’é™¤ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

é—®é¢˜ 1: ModuleNotFoundError: No module named 'torch'
  â†’ å®‰è£… PyTorch: pip install torch

é—®é¢˜ 2: æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨
  â†’ æ£€æŸ¥æ˜¯å¦è¿è¡Œäº† python run_spatial_comparison.py
  â†’ æ£€æŸ¥æ–‡ä»¶ä½ç½®: ls data/*.npz

é—®é¢˜ 3: è®­ç»ƒå¾ˆæ…¢ (CPU ä¸Š)
  â†’ è¿™æ˜¯æ­£å¸¸çš„ï¼Œå¯èƒ½éœ€è¦ 30-60 åˆ†é’Ÿ
  â†’ æˆ–å®‰è£… GPU ç‰ˆæœ¬çš„ PyTorch

é—®é¢˜ 4: å†…å­˜ä¸è¶³
  â†’ å‡å° batch_size: --batch_size 128
  â†’ å‡å°‘æ•°æ®: å¯ä»¥é‡‡æ ·éƒ¨åˆ†æ•°æ®

é—®é¢˜ 5: Loss ä¸æ”¶æ•›
  â†’ å‡å°å­¦ä¹ ç‡: --lr 0.0001
  â†’ å¢åŠ è®­ç»ƒè½®æ•°: --epochs 200


ã€ä¸è®ºæ–‡ä¿®æ”¹çš„å…³ç³»ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

è®­ç»ƒå®Œæˆåï¼Œç”¨å¾—åˆ°çš„æŒ‡æ ‡ï¼š

åœ¨è®ºæ–‡ Methods éƒ¨åˆ†æ·»åŠ :
  "We conducted an ablation study comparing two model variants:
   (1) baseline model with 6 local features and temporal lags;
   (2) enhanced model with 4 additional spatial aggregation features.
   Both variants use identical architecture (MLP with hidden layers [256, 128, 64])
   and training procedure."

åœ¨è®ºæ–‡ Experiments éƒ¨åˆ†æ·»åŠ è¡¨æ ¼:

  Table X: Effect of Spatial Context on Model Performance
  
  | Model Variant            | MAE (km/h) | RMSE (km/h) | RÂ²    |
  |:------------------------|:----------:|:----------:|:-----:|
  | Baseline (no spatial)    |  6.24      |  9.30      | 0.8333|
  | With spatial context     |  6.05      |  9.08      | 0.8420|
  | Improvement              | -3.0%      | -2.4%      | +1.0% |

åœ¨è®ºæ–‡ Experiments éƒ¨åˆ†æ·»åŠ è®¨è®º:
  "The inclusion of spatial aggregation features (upstream and downstream
   neighbor statistics) led to a 1.0% improvement in RÂ², suggesting that
   explicitly modeling local spatial context enhances the model's predictive
   capability. While the improvement is modest, it validates our hypothesis
   that traffic flow in adjacent road segments provides useful information."


ã€ä¸‹ä¸€æ­¥ã€‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ç¡®ä¿æ•°æ®å·²ç”Ÿæˆ (è¿è¡Œ python run_spatial_comparison.py)
2. è®­ç»ƒ baseline ç‰ˆæœ¬ (è®°å½• test æŒ‡æ ‡)
3. è®­ç»ƒ spatial ç‰ˆæœ¬ (è®°å½• test æŒ‡æ ‡)
4. æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹çš„æ€§èƒ½
5. ç”¨ç»“æœä¿®æ”¹è®ºæ–‡ (Methods + Experiments + Results)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

è„šæœ¬å·²åˆ›å»ºï¼ç°åœ¨å¯ä»¥å¼€å§‹ Ablation å®éªŒäº†ï¼ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
